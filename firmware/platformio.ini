; =============================================================================
; PlatformIO Konfiguration: Selection Panel (Modular)
; =============================================================================

[platformio]
default_envs = seeed_xiao_esp32s3

; =============================================================================
; Gemeinsame Einstellungen
; =============================================================================
[common]
build_flags =
    -std=gnu++17
    -Wall
    -Wextra
    -Werror=return-type
    -Wno-unused-parameter
    -ffunction-sections
    -fdata-sections

; =============================================================================
; Hauptumgebung: Seeed XIAO ESP32-S3
; =============================================================================
[env:seeed_xiao_esp32s3]
platform = espressif32
board = seeed_xiao_esp32s3
framework = arduino

; Serial
monitor_speed = 115200
monitor_filters = esp32_exception_decoder, colorize

; Build
build_flags =
    ${common.build_flags}
    -DARDUINO_USB_CDC_ON_BOOT=1
    -DARDUINO_USB_MODE=1

build_src_filter =
    +<*>

; Upload
upload_speed = 921600

; Statische Analyse (pio check)
check_tool = cppcheck
check_flags =
    cppcheck: --enable=all --std=c++17 --suppress=missingIncludeSystem

; =============================================================================
; Debug-Umgebung (optional)
; =============================================================================
[env:debug]
extends = env:seeed_xiao_esp32s3
build_type = debug
build_flags =
    ${common.build_flags}
    -DARDUINO_USB_CDC_ON_BOOT=1
    -DARDUINO_USB_MODE=1
    -DCORE_DEBUG_LEVEL=4
    -g3
    -Og
